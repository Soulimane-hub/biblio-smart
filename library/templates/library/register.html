{% load static %}

<!DOCTYPE html>
<html lang="en">

<head>
   <meta charset="UTF-8">
   <meta name="viewport" content="width=device-width, initial-scale=1.0">
   <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/all.min.css">
   <link rel="stylesheet" href="../static/css/style.css">
   <link href="https://fonts.googleapis.com/css2?family=Bookman+Old+Style&family=Garamond&display=swap" rel="stylesheet">
   <title>BiblioSmart | Connexion & Inscription</title>
   <style>
      body {
         background-color: #f0f5fa;
         background-image: url('data:image/svg+xml;utf8,<svg width="100" height="100" xmlns="http://www.w3.org/2000/svg"><rect width="100" height="100" fill="none" stroke="%23728eab" stroke-width="2" stroke-dasharray="5,5" /></svg>');
      }
      
      .container {
         background-color: #fff;
         border: 1px solid #728eab;
         box-shadow: 0 10px 30px rgba(26, 58, 90, 0.2);
      }
      
      .toggle {
         background: linear-gradient(135deg, #1a3a5a, #3f6a95);
      }
      
      .container button {
         background-color: #1a3a5a;
         border: 1px solid #5280af;
         transition: all 0.3s ease;
      }
      
      .container button:hover {
         background-color: #3f6a95;
         transform: translateY(-2px);
      }
      
      .container input {
         background-color: #f0f5fa;
         border: 1px solid #728eab;
         transition: all 0.3s ease;
      }
      
      .container input:focus {
         border-color: #5280af;
         box-shadow: 0 0 0 2px rgba(82, 128, 175, 0.2);
      }
      
      .site-title {
         color: #1a3a5a !important;
         font-family: 'Bookman Old Style', 'Garamond', serif;
      }
      
      h1 {
         color: #ffffff;
         font-family: 'Bookman Old Style', 'Garamond', serif;
      }
      
      .book-decoration {
         position: absolute;
         top: 10px;
         left: 10px;
         width: 40px;
         height: 40px;
         background-image: url('data:image/svg+xml;utf8,<svg width="40" height="40" xmlns="http://www.w3.org/2000/svg"><path d="M5,5 L35,5 L35,35 L5,35 Z" fill="none" stroke="%235280af" stroke-width="2" /></svg>');
         opacity: 0.7;
      }
      
      .library-decoration {
         position: fixed;
         top: 0;
         left: 0;
         right: 0;
         height: 15px;
         background: linear-gradient(90deg, #1a3a5a , #3f6a95 , #5280af , #1a3a5a , #728eab );
         z-index: 1000;
      }
      
      .library-decoration-bottom {
         position: fixed;
         bottom: 0;
         left: 0;
         right: 0;
         height: 5px;
         background: linear-gradient(90deg, #5280af, #728eab, #5280af);
         z-index: 1000;
      }
   </style>
</head>

<body>
   <div class="library-decoration"></div>
   <div class="library-decoration-bottom"></div>
   
   <div class="container" id="container">
      <div class="book-decoration"></div>
      <!-- Formulaire d'inscription (Sign Up) -->
      <div class="form-container sign-up">
         <form method="post" action="{% url 'register' %}">
            {% csrf_token %}
            <div class="site-branding" style="display:flex;align-items:center;justify-content:center;margin-bottom:20px;">
                <img src="{% static 'library/images/image.png' %}" alt="Logo bibliosmart" style="height:56px;width:56px;border-radius:50%;box-shadow:0 2px 8px rgba(201, 177, 140, 0.5);background:#fff;padding:5px;">
                <span class="site-title" style="font-size:2em;font-weight:700;margin-left:14px;letter-spacing:2px;text-shadow:0 1px 3px rgba(94, 75, 62, 0.2);">BiblioSmart</span>
            </div>
            <h1>Créer un compte</h1>
            {% if messages %}
              <ul class="messages-list">
                {% for message in messages %}
                  <li class="{{ message.tags }}">
                    {% if 'error' in message.tags or 'danger' in message.tags %}
                      <span class="msg-icon">&#9888;&#65039;</span>
                    {% elif 'success' in message.tags %}
                      <span class="msg-icon">&#9989;</span>
                    {% elif 'info' in message.tags %}
                      <span class="msg-icon">&#8505;</span>
                    {% elif 'warning' in message.tags %}
                      <span class="msg-icon">&#9888;&#65039;</span>
                    {% endif %}
                    {{ message|safe }}
                  </li>
                {% endfor %}
              </ul>
            {% endif %}
            <input type="text" name="username" placeholder="Username" required>
            <input type="email" name="email" placeholder="Email" required>
            <input type="password" name="password1" placeholder="Password" required>
            <button type="submit">S'inscrire</button>
         </form>
      </div>

      <!-- Formulaire de connexion (Sign In) -->
      <div class="form-container sign-in">
         <form method="post" action="{% url 'register' %}">
            {% csrf_token %}
            <div class="site-branding" style="display:flex;align-items:center;justify-content:center;margin-bottom:20px;">
                <img src="{% static 'library/images/image.png' %}" alt="Logo bibliosmart" style="height:56px;width:56px;border-radius:50%;box-shadow:0 2px 8px rgba(201, 177, 140, 0.5);background:#fff;padding:5px;">
                <span class="site-title" style="font-size:2em;font-weight:700;margin-left:14px;letter-spacing:2px;text-shadow:0 1px 3px rgba(94, 75, 62, 0.2);">BiblioSmart</span>
            </div>
            <h1>Connexion</h1>
            {% if messages %}
              <ul class="messages-list">
                {% for message in messages %}
                  <li class="{{ message.tags }}">
                    {% if 'error' in message.tags or 'danger' in message.tags %}
                      <span class="msg-icon">&#9888;&#65039;</span>
                    {% elif 'success' in message.tags %}
                      <span class="msg-icon">&#9989;</span>
                    {% elif 'info' in message.tags %}
                      <span class="msg-icon">&#8505;</span>
                    {% elif 'warning' in message.tags %}
                      <span class="msg-icon">&#9888;&#65039;</span>
                    {% endif %}
                    {{ message|safe }}
                  </li>
                {% endfor %}
              </ul>
            {% endif %}
            <span>Entrez votre email et mot de passe</span>
            <input type="email" name="email" placeholder="Email" required>
            <input type="password" name="password" placeholder="Password" required>
            <a href="#">Mot de passe oublié ?</a>
            <button type="submit">Se connecter</button>
         </form>
      </div>

      <!-- Section de bascule entre Sign In et Sign Up -->
      <div class="toggle-container">
         <div class="toggle">
            <div class="toggle-panel toggle-left">
               <h1>Bienvenue !</h1>
               <p>Entrez vos informations personnelles pour accéder à toutes les fonctionnalités de la bibliothèque</p>
               <button class="hidden" id="login">Se connecter</button>
            </div>
            <div class="toggle-panel toggle-right">
               <h1>Bonjour !</h1>
               <p>Inscrivez-vous pour découvrir notre collection de livres et emprunter vos ouvrages préférés</p>
               <button class="hidden" id="register">S'inscrire</button>
            </div>
         </div>
      </div>
   </div>
   <style>
     .messages-list {
       margin: 0 0 20px 0;
       padding: 0;
       list-style: none;
       max-width: 420px;
       margin-left: auto;
       margin-right: auto;
     }
     .messages-list li {
       margin-bottom: 8px;
       padding: 12px 18px;
       border-radius: 7px;
       font-size: 1em;
       font-weight: 500;
       box-shadow: 0 2px 8px #f6dede44;
       display: flex;
       align-items: center;
       gap: 8px;
     }
     .msg-icon {
       font-size: 1.3em;
       margin-right: 8px;
       display: inline-flex;
       align-items: center;
     }
     .messages-list li.error, .messages-list li.danger {
       background: #ffeaea;
       border: 1px solid #ef9a9a;
       color: #b71c1c;
     }
     .messages-list li.success {
       background: #e8f5e9;
       border: 1px solid #81c784;
       color: #1b5e20;
     }
     .messages-list li.info {
       background: #e3f2fd;
       border: 1px solid #64b5f6;
       color: #1565c0;
     }
     .messages-list li.warning {
       background: #fffde7;
       border: 1px solid #ffe082;
       color: #bfa600;
     }
   </style>
   <script src="{% static 'library/js/script.js' %}"></script>
   <script>
     // Supprime les messages à chaque refresh (hors soumission de formulaire)
     if (performance && performance.navigation && performance.navigation.type === 1) {
       // type 1 = reload (F5 ou bouton refresh)
       let msgLists = document.querySelectorAll('.messages-list');
       msgLists.forEach(function(list) { list.innerHTML = ''; });
     }
   </script>
</body>

</html>